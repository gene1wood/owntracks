<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="OwnTracks.org">
  <link rel="canonical" href="http://owntracks.org/features/card/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Card - OwnTracks Booklet</title>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Card";
    var mkdocs_page_input_path = "features/card.md";
    var mkdocs_page_url = "/features/card/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OwnTracks Booklet</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Intro</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/whathow/">What it does</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/clients/">Clients</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/scenarios/">Scenarios</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/apps/">Apps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/topics/">Topics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/broker/">Broker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/bridge/">Bridging</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/waypoints/">Waypoints</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/beacons/">Beacons</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Features</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../comparison/">Comparison</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ios/">iOS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../android/">Android</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../security/">Security</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tls/">TLS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tlscert/">TLS client</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../location/">Location</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tid/">Tracker ID</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../friends/">Friends</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Card</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#creating-a-card">Creating a card</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#shell-script">Shell Script</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#webapp">Webapp</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#generating-the-face-image">Generating the face image</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cards-in-recorder-in-http-mode">Cards in Recorder in HTTP mode</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tours/">Tours</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../waypoints/">Waypoints</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../beacons/">Beacons</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pedometer/">Pedometer</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../featured/">Featured</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../encrypt/">Encryption</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../remoteconfig/">Remoteconfig</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../debug/">Debugging</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../traccar/">Traccar</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../tech/json/">JSON</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tech/http/">HTTP</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tech/mqtt/">MQTT</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tech/qr/">URIs and QR codes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tech/program/">Code</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Sundry</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../terminology/">Terminology</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../clients/recorder/">Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../privacy/">Privacy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../people/">People</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../ideas/">Ideas</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../faq/">Answers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../press/">Press</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OwnTracks Booklet</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Features &raquo;</li>
        
      
    
    <li>Card</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/owntracks/booklet/edit/master/docs/features/card.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h2 id="card">Card</h2>
<p>OwnTracks typically displays the <em>TID</em> of a <a href="../friends/">friend</a> on the map, but you can associate an address book entry to that friend on iOS in order to see a friendly face (if you have you friend's photo in your device's address book) and/or a friendly name.</p>
<p><img alt="TID on iOS" src="../images/b-ipad-TID-map.png" /></p>
<p>We developed a new feature we call a <em>card</em> which you can use when in <em>Private mode</em> (MQTT) or in <em>HTTP mode</em>. A card is a retained message which contains a <a href="../../tech/json/">JSON payload</a> which, in absence of an address-book association, will be used to populate your friend on your map. The payload contains a full name (hopefully one you recognize), and an avatar -- a small image. If a card exists it will be used, but you can override its use in OwnTracks by associating your friend with an address book entry of your own device.</p>
<pre><code class="language-json">{
  &quot;_type&quot;: &quot;card&quot;,
  &quot;name&quot;: &quot;Jane Jolie&quot;,
  &quot;face&quot;: &quot;iV1CFEVkMhmCIKBUKh3 ... ghAAAAABJRU5ErkJggg==&quot;
}
</code></pre>
<h3 id="creating-a-card">Creating a card</h3>
<p>Cards can be created with shell scripts or with a webapp.</p>
<h4 id="shell-script">Shell Script</h4>
<p>We provide several utilities for creating a <em>card</em> in the <a href="https://github.com/owntracks/recorder/tree/master/contrib/faces">Recorder's repository</a>:</p>
<ul>
<li>If you have an image file you want to use, use <code>image2card.sh</code>, passing <em>image-filename</em> and <em>fullname</em>.</li>
<li>If you know a user has a Github profile with a name and an avatar, use <code>github2card.py</code> which takes a Github username as argument.</li>
<li>If you know a user has a Gravatar, use <code>gravatar2card.sh</code>, passing <em>email</em> and <em>fullname</em>.</li>
</ul>
<p>These utilities create a <em>card</em> on standard output, and you typically then publish the result as a retained message to your MQTT broker:</p>
<pre><code>./github2card.py defunkt &gt; my-card.json
mosquitto_pub -t owntracks/jjolie/phone/info -f my-card.json -r
</code></pre>
<p>Note the topic branch ending in <code>info</code> and note the use of the retain flag (<code>-r</code>).</p>
<h4 id="webapp">Webapp</h4>
<p>A <a href="https://avanc.github.io/owntracks-cards">webapp</a> is available to create cards in your browser and optionally publish them directly to your MQTT broker.</p>
<h3 id="generating-the-face-image">Generating the face image</h3>
<p>We recommend formatting the face image as a 192x192 pixel image, encoded either as a JPEG or as a PNG. It is possible to use larger or smaller images, but 192x192 provides a good balance between image fidelity and data usage. Remember that this image will be transmitted many times over cellular data to all phones that use the app, so using very large images can be very costly.</p>
<p>You should use JPEG encoding when the image depicts something complex, such as a photography of a real face. You should use PNG encoding when the image only contains simple flat colors, such as icons or drawings.</p>
<p>We also recommend compressing the image to further save on data usage. A good app for this is <a href="https://squoosh.app/">Squoosh</a>, but be warned that <a href="https://github.com/GoogleChromeLabs/squoosh#privacy">it uses Google trackers</a>. For JPEG, the MozJPEG encoder with default settings is usually very good, and for PNG, the OxiPNG encoder with default settings is usually very good.</p>
<h3 id="cards-in-recorder-in-http-mode">Cards in Recorder in HTTP mode</h3>
<p>Using HTTP mode in the OwnTracks Recorder will cause the Recorder to search for a friend's CARD in</p>
<pre><code>&lt;STORAGEDIR&gt;/cards/&lt;user&gt;/&lt;user&gt;-&lt;device&gt;.json
</code></pre>
<p>So, if <code>"jane"</code> is a friend with a device <code>"s8"</code>, the Recorder will load Jane's JSON card machine from the path <code>&lt;STORAGEDIR&gt;/cards/jane/jane-s8.json.</code> Note that as usual in Recorder, usernames and device names are lowercased.</p>
<p>In <code>contrib/faces/</code> of the Recorder distribution there are some small utilities which can help create CARDs. Please make sure to verify that the <code>.json</code> file which you place into the directory is readable by the Recorder and is valid JSON. (You can test that with <code>jq . &lt; file.json</code> or <code>python -mjson.tool file.json</code>.)</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tours/" class="btn btn-neutral float-right" title="Tours">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../friends/" class="btn btn-neutral" title="Friends"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/owntracks/booklet/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../friends/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../tours/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
