<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Beacons - OwnTracks Booklet</title>
  

  <link rel="shortcut icon" href="../../favicon.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/custom.css" rel="stylesheet">

  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OwnTracks Booklet</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Intro</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Guide</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/whathow/">What it does</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/clients/">Clients</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/scenarios/">Scenarios</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/apps/">Apps</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/topics/">Topics</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/broker/">Broker</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/bridge/">Bridging</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/waypoints/">Waypoints</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../guide/beacons/">Beacons</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Features</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../comparison/">Comparison</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../ios/">iOS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../android/">Android</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../security/">Security</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tls/">TLS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tlscert/">TLS client</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../location/">Location</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../tid/">Tracker ID</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../friends/">Friends</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../card/">Card</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../waypoints/">Waypoints</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Beacons</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#ibeacons">iBeacons</a></li>
                
            
                <li class="toctree-l3"><a href="#notes">Notes</a></li>
                
            
                <li class="toctree-l3"><a href="#example-office">Example: office</a></li>
                
            
                <li class="toctree-l3"><a href="#more-examples">More examples</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../pedometer/">Pedometer</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../featured/">Featured</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../encrypt/">Encryption</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../remoteconfig/">Remoteconfig</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../debug/">Debugging</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../traccar/">Traccar</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>API</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/json/">JSON</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/http/">HTTP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/mqtt/">MQTT</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/qr/">URIs and QR codes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tech/program/">Code</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Sundry</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../terminology/">Terminology</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../clients/recorder/">Docker</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../privacy/">Privacy</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../people/">People</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../ideas/">Ideas</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">Answers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../press/">Press</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OwnTracks Booklet</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Features &raquo;</li>
        
      
    
    <li>Beacons</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/owntracks" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="ibeacons">iBeacons</h2>
<p>If you want to monitor an iBeacon region rather than a circular region set the
radius to zero (<code>0</code>) or a negative value (iOS only), and add the beacon UUID, major, and minor numbers.</p>
<p><img alt="Beacon configuration" src="../images/b-waypoint-config-ibeacon.jpg" /></p>
<p>Set the UUID of the beacon, and you can optionally specify the major and/or
minor identifier numbers of the beacons as a decimal number ranging from 1 to 65535 if you desire finer control over which beacons OwnTracks will monitor.
Setting major or minor number to zero (<code>0</code>) means no major or minor number is specified.
Note that you should probably not use major or minor number <code>0</code>, because the meaning of 0 is "any".</p>
<p>If the UUID is valid, iBeacon monitoring will start.</p>
<p>Examples:</p>
<pre><code>Name  myBeacons
UUID  CA271EAE-5FA8-4E80-8F08-2A302A95A959
Major 0
Minor 0

Name  mySpecificBeacon
UUID  CA271EAE-5FA8-4E80-8F08-2A302A95A959
Major 1
Minor 33000
</code></pre>

<p>In the first example above, OwnTracks will monitor all beacons with the specified UUID, whereas
in the second example, OwnTracks would monitor just that one specific beacon with the major number <code>1</code> and the minor number <code>33000</code>.</p>
<h2 id="notes">Notes</h2>
<p>The app recognizes the beacon typically within 10 seconds, which is a typical beacon-publishing frequency, and this is very good for presence detection.</p>
<p>If you use a <code>-</code> as the first character in your Waypoint description e.g. <code>-MyBeacon</code>, the app will ignore short disruptions of the connection to the beacon (hold down).</p>
<p>Setting the radius to a negative value (e.g. <code>-1</code>) on iOS, the app will update the location coordinates of the waypoint on each enter/leave event. This update will be transmitted to the broker when the <code>share</code> option is on and will be reflected on your map screen. You may use this to keep track of moveable items as luggage or your car.</p>
<h2 id="example-office">Example: office</h2>
<p>Upon arriving at our Frankfurt location, I see from the monitor panel at the reception that Jane is in the office, so I'll pop in to ask a question.</p>
<p><img alt="office panel" src="../images/ot-beacons-office-panel.png" /></p>
<p>Instead of relying solely on the location your smart phone thinks you are at, small, and relatively inexpensive <a href="http://en.m.wikipedia.org/wiki/IBeacon">iBeacons</a> can pinpoint you down to a few meters. OwnTracks for iOS has had support for iBeacons for a few releases now, and it works very reliably.</p>
<p>Beacons use Bluetooth low energy to transmit a UUID (typically modifiable) together with user-defined <em>major</em> and <em>minor</em> numbers, and these allow us to identify, say, a particular room in a building or even a specific corner of a room. The <em>major</em> number can be used, say, to identify an office building, whereas you'd configure a beacon's <em>minor</em> number to identify a room within that building. Alternatively, if you don't want to bother with identifying rooms, you can e.g. set all beacons to have the same <em>major</em> and <em>minor</em> numbers.</p>
<p>Let's assume the office we're discussing has a few beacons. Let's further assume we do not want to track people within a particular room; instead we just want to capture whether an employee is in this particular office building. We can configure all beacons with the same UUID, and we will ignore the <em>major</em> and <em>minor</em> numbers. (How a beacon gets it's UUID, <em>major</em>, and <em>minor</em> set depends on the product.)</p>
<p>We define a UUID, say, <code>DEADBEEF-ABBA-CAFE-AFFE-123456789012</code> which we assign to all beacons, and configure them accordingly. (The <a href="http://www.blukii.com/beacons_en.html">Blukii</a> iBeacons we use have a utility with which we can configure them accordingly.)</p>
<p>What we then do is configure a waypoint within the iOS OwnTracks app. The values for latitude/longitude are irrelevant. What is important is the UUID separated from the name of the beacon (I chose <code>Main@WestWing</code> here) by a colon. A beacon's <em>major</em> and <em>minor</em> are optionally concatenated to that string, also colon-separated.</p>
<p>Instead of painstakingly configuring this on the device proper, I prepare a small file called <code>office.otrw</code> (the <code>.otrw</code> extension is important), with the following <a href="../../tech/json/">JSON</a> payload:</p>
<pre><code class="json">{
  &quot;waypoints&quot; : [
    {
      &quot;tst&quot; : 1432817332,
      &quot;lat&quot; : 52.0,
      &quot;_type&quot; : &quot;waypoint&quot;,
      &quot;lon&quot; : 6.0,
      &quot;rad&quot; : 0,
      &quot;desc&quot; : &quot;Main@WestWing:DEADBEEF-ABBA-CAFE-AFFE-123456789012:0001&quot;
    }
  ],
  &quot;_type&quot; : &quot;waypoints&quot;
}
</code></pre>

<p>I then either place that file on a Web server, or e-mail it as attachment to my colleagues who open that on their OwnTracks device, and presto: the device has the beacon monitoring regions configured.</p>
<p>From this point on, OwnTracks monitors all beacons with that particular UUID, and it will publish an <code>enter</code> or <code>leave</code> event whenever the device gets within range of a beacon or leaves it. Additionally, the device shows the event with a local iOS notification.</p>
<p><img alt="iBeacon notification on iPhone" src="../images/ot-beacon-enter-notif.png" /></p>
<p>We publish these <a href="../../tech/json/">events as JSON</a> via MQTT to the MQTT broker the device is connected to, and from there, you consume the message and do as you please.</p>
<pre><code class="json">{
    &quot;_type&quot;: &quot;transition&quot;,
    &quot;acc&quot;: 65,
    &quot;desc&quot;: &quot;Main@WestWing&quot;,
    &quot;event&quot;: &quot;enter&quot;,
    &quot;lat&quot;: 2.2222,
    &quot;lon&quot;: 1.1111,
    &quot;tid&quot;: &quot;jp&quot;,
    &quot;tst&quot;: 1433342520,
    &quot;wtst&quot;: 1432817332
}
</code></pre>

<p>For instance, send an e-mail when a particular person leaves the building, publish a list of people who remain in the building on a monitor (as above), etc.</p>
<p>To summarize: OwnTracks can monitor beacons by configuring it either with:</p>
<ul>
<li>a <em>UUID</em> only, in which case the app would report any beacon with that UUID, irrespective of its <em>major</em>/<em>minor</em> numbers.</li>
<li>a <em>UUID</em> with a <em>major</em> number: the app would report iBeacons with the specified UUID and exactly that <em>major</em> number</li>
<li>all three: the <em>UUID</em>, the <em>major</em> and <em>minor</em> numbers, in which case the app reports events on precisely that beacon.</li>
</ul>
<h2 id="more-examples">More examples</h2>
<ul>
<li><a href="http://jpmens.net/2016/01/02/where-exactly-did-i-park-my-car/">Where exactly did I park my car?</a></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pedometer/" class="btn btn-neutral float-right" title="Pedometer"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../waypoints/" class="btn btn-neutral" title="Waypoints"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../waypoints/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../pedometer/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
