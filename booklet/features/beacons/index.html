<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="OwnTracks.org" /><link rel="canonical" href="http://owntracks.org/features/beacons/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Beacons - OwnTracks Booklet</title>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link href="../../extra.css" rel="stylesheet">
    
      <script>
        // Current page data
        var mkdocs_page_name = "Beacons";
        var mkdocs_page_input_path = "features/beacons.md";
        var mkdocs_page_url = "/features/beacons/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]--> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> OwnTracks Booklet
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Intro</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/whathow/">What it does</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/quicksetup/">Quicksetup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../guide/apps/">Apps</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Features</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../comparison/">Comparison</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../security/">Security</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../location/">Location</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tech/json/">JSON</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tech/http/">HTTP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tech/program/">Code</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Sundry</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../privacy/">Privacy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../people/">People</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../faq/">Answers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../press/">Press</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">OwnTracks Booklet</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Beacons</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/owntracks/booklet/edit/master/docs/features/beacons.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="ibeacons">iBeacons</h2>
<p>If you want to monitor an iBeacon region rather than a circular region set the
radius to zero (<code>0</code>) or a negative value (iOS only), and add the beacon UUID, major, and minor numbers.</p>
<p><img alt="Beacon configuration" src="../images/b-waypoint-config-ibeacon.jpg" /></p>
<p>Set the UUID of the beacon, and you can optionally specify the major and/or
minor identifier numbers of the beacons as a decimal number ranging from 1 to 65535 if you desire finer control over which beacons OwnTracks will monitor.
Setting major or minor number to zero (<code>0</code>) means no major or minor number is specified.
Note that you should probably not use major or minor number <code>0</code>, because the meaning of 0 is "any".</p>
<p>If the UUID is valid, iBeacon monitoring will start.</p>
<p>Examples:</p>
<pre><code>Name  myBeacons
UUID  CA271EAE-5FA8-4E80-8F08-2A302A95A959
Major 0
Minor 0

Name  mySpecificBeacon
UUID  CA271EAE-5FA8-4E80-8F08-2A302A95A959
Major 1
Minor 33000
</code></pre>
<p>In the first example above, OwnTracks will monitor all beacons with the specified UUID, whereas
in the second example, OwnTracks would monitor just that one specific beacon with the major number <code>1</code> and the minor number <code>33000</code>.</p>
<h2 id="notes">Notes</h2>
<p>The app recognizes the beacon typically within 10 seconds, which is a typical beacon-publishing frequency, and this is very good for presence detection.</p>
<p>If you use a <code>-</code> as the first character in your Waypoint description e.g. <code>-MyBeacon</code>, the app will ignore short disruptions of the connection to the beacon (hold down).</p>
<p>Setting the radius to a negative value (e.g. <code>-1</code>) on iOS, the app will update the location coordinates of the waypoint on each enter/leave event. This update will be transmitted to the broker when the <code>share</code> option is on and will be reflected on your map screen. You may use this to keep track of moveable items as luggage or your car.</p>
<h2 id="example-office">Example: office</h2>
<p>Upon arriving at our Frankfurt location, I see from the monitor panel at the reception that Jane is in the office, so I'll pop in to ask a question.</p>
<p><img alt="office panel" src="../images/ot-beacons-office-panel.png" /></p>
<p>Instead of relying solely on the location your smart phone thinks you are at, small, and relatively inexpensive <a href="http://en.m.wikipedia.org/wiki/IBeacon">iBeacons</a> can pinpoint you down to a few meters. OwnTracks for iOS has had support for iBeacons for a few releases now, and it works very reliably.</p>
<p>Beacons use Bluetooth low energy to transmit a UUID (typically modifiable) together with user-defined <em>major</em> and <em>minor</em> numbers, and these allow us to identify, say, a particular room in a building or even a specific corner of a room. The <em>major</em> number can be used, say, to identify an office building, whereas you'd configure a beacon's <em>minor</em> number to identify a room within that building. Alternatively, if you don't want to bother with identifying rooms, you can e.g. set all beacons to have the same <em>major</em> and <em>minor</em> numbers.</p>
<p>Let's assume the office we're discussing has a few beacons. Let's further assume we do not want to track people within a particular room; instead we just want to capture whether an employee is in this particular office building. We can configure all beacons with the same UUID, and we will ignore the <em>major</em> and <em>minor</em> numbers. (How a beacon gets it's UUID, <em>major</em>, and <em>minor</em> set depends on the product.)</p>
<p>We define a UUID, say, <code>DEADBEEF-ABBA-CAFE-AFFE-123456789012</code> which we assign to all beacons, and configure them accordingly. (The <a href="http://www.blukii.com/beacons_en.html">Blukii</a> iBeacons we use have a utility with which we can configure them accordingly.)</p>
<p>What we then do is configure a waypoint within the iOS OwnTracks app. The values for latitude/longitude are irrelevant. What is important is the UUID separated from the name of the beacon (I chose <code>Main@WestWing</code> here) by a colon. A beacon's <em>major</em> and <em>minor</em> are optionally concatenated to that string, also colon-separated.</p>
<p>Instead of painstakingly configuring this on the device proper, I prepare a small file called <code>office.otrw</code> (the <code>.otrw</code> extension is important), with the following <a href="../../tech/json/">JSON</a> payload:</p>
<pre><code class="language-json">{
  &quot;waypoints&quot; : [
    {
      &quot;tst&quot; : 1432817332,
      &quot;lat&quot; : 52.0,
      &quot;_type&quot; : &quot;waypoint&quot;,
      &quot;lon&quot; : 6.0,
      &quot;rad&quot; : 0,
      &quot;desc&quot; : &quot;Main@WestWing:DEADBEEF-ABBA-CAFE-AFFE-123456789012:0001&quot;
    }
  ],
  &quot;_type&quot; : &quot;waypoints&quot;
}
</code></pre>
<p>I then either place that file on a Web server, or e-mail it as attachment to my colleagues who open that on their OwnTracks device, and presto: the device has the beacon monitoring regions configured.</p>
<p>From this point on, OwnTracks monitors all beacons with that particular UUID, and it will publish an <code>enter</code> or <code>leave</code> event whenever the device gets within range of a beacon or leaves it. Additionally, the device shows the event with a local iOS notification.</p>
<p><img alt="iBeacon notification on iPhone" src="../images/ot-beacon-enter-notif.png" /></p>
<p>We publish these <a href="../../tech/json/">events as JSON</a> via MQTT to the MQTT broker the device is connected to, and from there, you consume the message and do as you please.</p>
<pre><code class="language-json">{
    &quot;_type&quot;: &quot;transition&quot;,
    &quot;acc&quot;: 65,
    &quot;desc&quot;: &quot;Main@WestWing&quot;,
    &quot;event&quot;: &quot;enter&quot;,
    &quot;lat&quot;: 2.2222,
    &quot;lon&quot;: 1.1111,
    &quot;tid&quot;: &quot;jp&quot;,
    &quot;tst&quot;: 1433342520,
    &quot;wtst&quot;: 1432817332
}
</code></pre>
<p>For instance, send an e-mail when a particular person leaves the building, publish a list of people who remain in the building on a monitor (as above), etc.</p>
<p>To summarize: OwnTracks can monitor beacons by configuring it either with:</p>
<ul>
<li>a <em>UUID</em> only, in which case the app would report any beacon with that UUID, irrespective of its <em>major</em>/<em>minor</em> numbers.</li>
<li>a <em>UUID</em> with a <em>major</em> number: the app would report iBeacons with the specified UUID and exactly that <em>major</em> number</li>
<li>all three: the <em>UUID</em>, the <em>major</em> and <em>minor</em> numbers, in which case the app reports events on precisely that beacon.</li>
</ul>
<h2 id="more-examples">More examples</h2>
<ul>
<li><a href="http://jpmens.net/2016/01/02/where-exactly-did-i-park-my-car/">Where exactly did I park my car?</a></li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/owntracks/booklet" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
