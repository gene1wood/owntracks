<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="OwnTracks.org">
  <link rel="canonical" href="http://owntracks.org/features/location/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Location - OwnTracks Booklet</title>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link href="../../extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Location";
    var mkdocs_page_input_path = "features/location.md";
    var mkdocs_page_url = "/features/location/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OwnTracks Booklet</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Intro</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Guide</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/whathow/">What it does</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/quicksetup/">Quicksetup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/clients/">Clients</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../guide/apps/">Apps</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Features</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../comparison/">Comparison</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../security/">Security</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Location</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#ios">iOS</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#move-mode">Move mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#significant-location-change-mode">Significant location change mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#manual-mode">Manual mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#quiet-mode">Quiet mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#region-monitoring">Region monitoring</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#tags-and-poi">Tags and POI</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ibeacon-monitoring">iBeacon monitoring</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#android">Android</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#move-mode_1">Move mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#significant-location-change-mode_1">Significant location change mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#manual-mode_1">Manual mode</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#quiet-mode_1">Quiet mode</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../tech/json/">JSON</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tech/http/">HTTP</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tech/program/">Code</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Sundry</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../clients/recorder/">Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../privacy/">Privacy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../people/">People</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../faq/">Answers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../press/">Press</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OwnTracks Booklet</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Features &raquo;</li>
        
      
    
    <li>Location</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/owntracks/booklet/edit/master/docs/features/location.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h2 id="location-data">Location data</h2>
<p>We support 4 distinct modes of location publication and region monitoring as pertains to data submitted to the <a href="../../guide/broker/">MQTT broker</a> by our apps:</p>
<ul>
<li><em>Quiet</em> mode: Only manual location reports. Icon <code>[]</code></li>
<li><em>Manual</em> mode: Manual location reports and automated reports with region monitoring. Icon <code>||</code></li>
<li><em>Significant location change</em> mode: Standard tracking mode with automated location reports. Icon <code>|&gt;</code></li>
<li><em>Move</em> mode: Frequent location  <code>||&gt;</code></li>
</ul>
<p>All four modes work the same but behave slightly different on iOS or Android. In addition to region monitoring, iOS also supports location reporting based on <a href="../beacons/">iBeacons</a>. </p>
<h3 id="ios">iOS</h3>
<h4 id="move-mode"><em>Move</em> mode</h4>
<p>In <em>move</em> mode, the app monitors location permanently and publishes a new
location as soon as the device moves <code>locatorDisplacement</code> meters or after <code>locatorInterval</code> seconds, whatever
happens first. <code>locatorDisplacement</code> and <code>locatorInterval</code> can be adjusted by the user in the systems settings for
OwnTracks. The defaults are 100m and 300 seconds (5 minutes). </p>
<p>The payoff is higher battery usage as high as in navigation or tracker app.
So it is recommend to use <em>move</em> mode while charging or during moves only - hence the name.</p>
<p>Please note, <em>move</em> mode is active when the app is active (a.k.a in foreground).</p>
<h4 id="significant-location-change-mode"><em>Significant location change</em> mode</h4>
<p>iOS defines a <em>Significant location change</em> as traveling a distance of at least
500 meters in 5 minutes.  This mode allows the app to run in background and
minimize the power consumption.</p>
<p>This standard tracking mode reports significant location changes only (&gt;500m
and at most once every 5 minutes).  This is defined by Apple and is optimal
with respect to battery usage.</p>
<p>Examples:</p>
<ul>
<li>if you don't move, no new location is published - even if you don't move for hours. (Note, however, that the app will publish a <em>ping</em>-type message once in a while.)</li>
<li>if you move at least 500 meters, a new location will be published after 5 minutes</li>
<li>if you move 10 kilometers in 5 minutes, only one location will be published</li>
</ul>
<h4 id="manual-mode"><em>Manual</em> mode</h4>
<p>The app doesn't monitor location changes in <em>manual</em> mode while in background.
The user has to publish the current location explicitly via the UI. You use this if
you want to (temporarily) avoid friends seeing where you are. Note that Region events
triggered by entering or leaving Geo Fence or Beacon regions
are still published automatically whilst in <em>Manual</em> mode.</p>
<h4 id="quiet-mode"><em>Quiet</em> mode</h4>
<p>Same as <em>Manual</em> mode except that no region events are published.</p>
<h4 id="region-monitoring"><em>Region</em> monitoring</h4>
<p>The app user may mark a previously manually published or manually created 
location as a monitored circular region by specifying a monitoring radius in meters. (See <a href="../waypoints/">Regions</a>.)
The app will publish the location
additionally every time the device leaves or enters one of the regions, and the
published data contains an indication of whether the device is entering or
leaving the region.</p>
<p>Region monitoring is not related to one of the location publication modes and
works independently thereof. It is switched on when a region is setup with description
and radius. To switch region monitoring off, all regions have to be 
unmarked (by setting their radius to 0).</p>
<p>Regions are shown on the map display in transparent blue or red circles. Red
indicates the device is is within the region.</p>
<h4 id="tags-and-poi"><em>Tags</em> and <em>POI</em></h4>
<p>On iOS, a user can set a point of interest (POI) during manual publish of a location or set a tag while for future location publishes. When tapping on "publish location" an action picker appears on which the user can choose to:</p>
<p><img alt="iOS action picker when publishing a location" src="../images/ios-action-picker.png" /></p>
<ul>
<li>Send location now. The current location is published, possibly enhanced with a previously set <code>tag</code>.</li>
<li>Set POI. A user is asked to describe the POI (e.g. <code>delicious seafood</code>) and the location is then transmitted with the <code>poi</code> added to the JSON payload.</li>
<li>Set tag. Users can enter a tag (e.g. <code>Spain 2023</code>) which is added to the JSON of all subsequent location publishes, irrespective of the mode (i.e. this also works in significant changes mode, say), until the tag is removed.</li>
</ul>
<h4 id="ibeacon-monitoring">iBeacon monitoring</h4>
<p>The app user may mark a previously manually published or manually created location
as a monitored beacon region by appending a beacon UUID to the region's name.
The app will publish the location
additionally every time the device leaves or enters one of the beacon regions, and the
published data contains an indication of whether the device is entering or
leaving the region.</p>
<p>Region monitoring is not related to one of the location publication modes and
works independently. It is switched on when a region's name has a valid UUID
appended to it.</p>
<p>If the device is within a monitored beacon region, the the beacon indicator
is shown in red, otherwise blue meaning device is not in any iBeacon region.</p>
<p>There are 2 kinds of locations:</p>
<ul>
<li>an <em>automatic location</em> created when iOS detects a change of location</li>
<li>a <em>manual location</em> created by the user</li>
</ul>
<p>A <em>manual location</em> with a non-zero length remark (description) is a <em>waypoint</em>.</p>
<p>A <em>waypoint</em>'s attributes are published when the waypoint is created or changed.</p>
<p>If a <em>waypoint</em> specifies a radius, a <em>circular region</em> is monitored for <em>enter/leave events</em>.</p>
<p>If a <em>waypoint</em> is not a <em>circular region</em> and the waypoint's description contains a valid iBeacon specification, a <em>beacon region</em> is monitored for enter/leave events.</p>
<p>If an enter/leave event occurs an event message is published with the <code>type</code> attribute set to <code>c</code>or <code>b</code>for (<em>circular region_or _beacon region</em>). The message contains an <code>event</code> attribute specifying either <code>enter</code>or <code>leave</code>.</p>
<p>The description of the <em>waypoint</em> is added to the published <code>event</code> message.</p>
<table>
<thead>
<tr>
<th>Automatic</th>
<th>Description</th>
<th>iBeacon</th>
<th>Radius</th>
<th>Event Message</th>
<th>/w Description</th>
<th>Waypoint Message</th>
</tr>
</thead>
<tbody>
<tr>
<td>Y</td>
<td>n/a</td>
<td>n/a</td>
<td>n/a</td>
<td>N</td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>N</td>
<td>N</td>
<td>n/a</td>
<td>n/a</td>
<td>N</td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>N</td>
<td>Y</td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>N</td>
<td>Y</td>
<td><code>c</code></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>N</td>
<td>Y</td>
<td><code>c</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
<td><code>b</code></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
<td><code>b</code></td>
<td>Y</td>
<td>Y</td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td><code>c</code></td>
<td>N</td>
<td>N</td>
</tr>
<tr>
<td>N</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td><code>c</code></td>
<td>Y</td>
<td>Y</td>
</tr>
</tbody>
</table>
<h3 id="android">Android</h3>
<h4 id="move-mode_1"><em>Move</em> mode</h4>
<p>In <em>move</em> mode, the app monitors device location permanently. It requests a location fix every 10s (by default, configurable in the settings through <code>moveModeLocatorInterval</code>) in high power mode and publishes a new location as soon as it arrives. </p>
<p>This mode mostly relies on GPS location data and is hence the most accurate. The payoff is a higher battery usage.
It is recommend to use <em>move</em> mode while charging or during periods that require highly accurate tracking while moving quickly. </p>
<p>The <code>locatorDisplacement</code> option is ignored in this mode.</p>
<h4 id="significant-location-change-mode_1"><em>Significant location change</em> mode</h4>
<p>This standard tracking mode is aimed at everyday usage for location tracking in the background. It uses a balanced power location request that gathers a new location fix every 15 minutes. Location data from other apps is reused and published as soon as it arrives. </p>
<p>This mode relies mostly on cell tower and WiFi location to conserve power to provide location data that is sufficiently accurate for most users. </p>
<p>In addition to the default settings, all location request parameters in this mode can also be changed. These parameters directly influence the raw <a href="https://developers.google.com/android/reference/com/google/android/gms/location/LocationRequest">location request</a> that is send to the Android location API.  </p>
<ul>
<li>
<p><code>locatorInterval</code>: The <a href="https://developers.google.com/android/reference/com/google/android/gms/location/LocationRequest#public-locationrequest-setinterval-long-millis">desired interval</a> for active location updates.</p>
<blockquote>
<p>"The location client will actively try to obtain location updates for your application at this interval, so it has a direct influence on the amount of power used by your application. Choose your interval wisely."</p>
</blockquote>
</li>
<li>
<p><code>moveModeLocatorInterval</code>: The requested location interval in <em>move</em> mode.</p>
</li>
<li>
<p><code>locatorDisplacement</code>: The smallest displacement in meters the user must move between location updates. Defaults to 0 and is an <code>and</code> relationship with interval. Can be used to only receive updates when the device has moved.</p>
<ul>
<li>This means if the user has not moved by more than the displacement value, the location will not be reported at <code>locatorInterval</code>.</li>
</ul>
</li>
</ul>
<h4 id="manual-mode_1"><em>Manual</em> mode</h4>
<p>In <em>manual</em> mode, the app monitors device location with a low power location request. It uses the same interval configured for <em>significant mode</em> to receive low accuracy updates to use minimal battery power. </p>
<p>The user has to publish the current location explicitly via the UI. You use this if you want to (temporarily) avoid friends seeing where you are. Note that Region events triggered by entering or leaving Geo Fence are still published automatically whilst in <em>Manual</em> mode.</p>
<p>Remote <code>reportLocation</code> commands are ignored. </p>
<h4 id="quiet-mode_1"><em>Quiet</em> mode</h4>
<p>Same as <em>Manual</em> mode except that no region events are published.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../tech/json/" class="btn btn-neutral float-right" title="JSON">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../security/" class="btn btn-neutral" title="Security"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/owntracks/booklet/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../security/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../tech/json/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
